# AGENT SYSTEM GUIDE ü§ñ

**Objective:** This document provides a high-level technical map of the `PJX` system architecture to assist AI Agents and Developers in navigating and modifying the codebase efficiently.

## 1. System Architecture (`assets/system/`)

The project uses a rigorous **Modular Architecture**. Logic and Styles are strictly separated but aligned by naming convention.

### üåê Module Configuration

- **Source of Truth:** `assets/system/config.js`
- **Rule:** Always check this file to confirm if a module is active/loaded.

### üìÇ Directory Structure

#### JavaScript (`assets/system/js/`)

- **`ui/`** -> Constant UI elements (Topbar, MainMenu, Rightbar, Phone).
- **`modal/`** -> Dialog systems (Settings, Character, Stats).
- **`system/`** -> Core logic (Wardrobe, Location).
- **`utils/`** -> Helpers (Modal base, Notifications).

#### CSS (`assets/system/css/`)

- **`base/`** -> Variables & Reset ONLY.
  - ‚ùå **DO NOT USE** `base.css` (Deprecated/Empty).
  - ‚úÖ **USE** `base/variables.css` for colors/spacing tokens.
- **`layout/`** -> Structural grids (Topbar, Structure, Rightbar).
- **`ui/`** -> Atomic components (Buttons, Forms, Modals).
- **`screens/`** -> Full-page layouts (Welcome, GameSetup).
- **`systems/`** -> Feature-specific styles (Wardrobe, Character, Phone).

---

## 2. Critical Implementation Protocols ‚ö†Ô∏è

### A. Modal System

- **Generation:** `js/utils/modal.js` creates modals dynamically.
- **Width Control:** `css/ui/modals.css`.
  - **Rule:** Default width is `500px`. To use a wider modal (e.g. 800px+), you **MUST** whitelist the modal ID in `css/ui/modals.css` using the attribute selector:
    ```css
    .modal-overlay[data-modal="your-modal-id"] .modal {
      max-width: 800px;
      width: 90%;
    }
    ```
  - _Do not try to set effective width via inline JS styles alone, CSS overrides it._

### B. Topbar Alignment (Hamburger Menu)

- **Mechanism:** The Hamburger menu is vertically centered via **Flexbox** inside a wrapper with a **Min-Height**.
- **Critical CSS:** `assets/system/css/layout/structure.css`
  ```css
  /* Ensures button stays centered even when topbar content is hidden */
  .top-bar-wrapper {
    min-height: 90px;
    display: flex;
    align-items: center;
  }
  ```
- **Rule:** Do not remove `min-height` or change `display: flex` on the wrapper, or the button will "jump" when switching between Game and Settings screens.

### C. Inline Styles vs CSS

- **Observation:** Some JS files (e.g. `settings.js`) use heavy inline styles.
- **Protocol:**
  - **Existing Code:** Respect existing inline styles but fix specific layout bugs (e.g. add `width: 100%` / `align-items: stretch` for flex columns).
  - **New Code:** PREFER creating classes in `assets/system/css/systems/` over adding complex string-based inline styles.

---

## 3. Quick Reference Map

| Feature       | JS File                 | CSS File                    |
| ------------- | ----------------------- | --------------------------- |
| **Settings**  | `js/modal/settings.js`  | `css/screens/gamesetup.css` |
| **Stats**     | `js/modal/stats.js`     | `css/systems/profile.css`   |
| **Wardrobe**  | `js/system/wardrobe.js` | `css/systems/wardrobe.css`  |
| **Top Bar**   | `js/ui/topbar.js`       | `css/layout/topbar.css`     |
| **Right Bar** | `js/ui/rightbar.js`     | `css/layout/rightbar.css`   |

---

_Generated by Antigravity - January 2026_
